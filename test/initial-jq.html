<!DOCTYPE html>
<html>
<head>
	<title>Testing</title>
	<style type="text/css">
		.out {
			background-color: #eee;
			margin: 15px 30px;
		}
	</style>
</head>
<body>
	<h1>Testing environment</h1>
	<div class="out">
		
	</div>
	<footer id="footer"></footer>
	<script type="text/javascript" src="../dist/scheson.js"></script>
	<script
			  src="https://code.jquery.com/jquery-3.2.1.min.js"
			  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
			  crossorigin="anonymous"></script>
	<script type="text/javascript">
		const $out = $('.out').first();

		const goods = [
			{ 
				json:	'./object-two_props.good1.json',
				schema: './object-two_props.schema.json'
			},
			{
				json:	'./string-anglo_name.good1.json',
				schema: './string-anglo_name.schema.json'
			}
		];
		const bads = [
			{
				json:	'./object-two_props.good1.json',
				schema: './array-anglo_names.schema.json'
			},
			{
				json:	'./array-anglo_names.bad1.json',
				schema: './array-anglo_names.schema.json'
			},
			{
				json:	'./array-anglo_names.good1.json',
				schema: './array-defined_items_opened.schema.json'
			},
		];
		function doValidate(json, schema, jsonUrl, schemaUrl) {
 			const validate = Scheson.check(json, schema);
 			console.log(jsonUrl);
			$out.append('<div>' + jsonUrl + ' against ' + schemaUrl + '</div>');
			$out.append('<pre>' + JSON.stringify(validate, null, 2) + '</pre>');
		}
		function errback(url, error) {
			console.error(error + ' in ' + url);
		}
		goods.forEach(function (item) {
console.log(item);
			$.ajax( {
				url: item.schema, 
				dataType: 'json',
				success: function(schemaResponse) {
					$.ajax({
						url: item.json,
						dataType: 'json',
						success: function(jsonResponse) {
							// doValidate(jsonResponse, schemaResponse, item.json, item.schema);
						 			const validate = Scheson.check(jsonResponse, schemaResponse);
						 			console.log(item.json);
									$out.append('<div>' + item.json + ' against ' + item.schema + '</div>');
									$out.append('<pre>' + JSON.stringify(validate, null, 2) + '</pre>');
						},
						fail: function(error) {
							console.error(error, 'in ' + item.json)
						}
					});
				}, 
				fail: errback
			});

		})
	</script>
</body>
</html>